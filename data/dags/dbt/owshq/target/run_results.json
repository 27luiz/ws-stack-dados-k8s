{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.8", "generated_at": "2024-02-23T20:06:39.735929Z", "invocation_id": "b3b17b73-d5be-4eea-85fd-cf81000f495c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-23T20:06:38.969512Z", "completed_at": "2024-02-23T20:06:38.975461Z"}, {"name": "execute", "started_at": "2024-02-23T20:06:38.976193Z", "completed_at": "2024-02-23T20:06:39.730446Z"}], "thread_id": "Thread-1", "execution_time": 0.7639639377593994, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.8\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.ride_transactions\"} */\n\n  create or replace view\n    \"iceberg\".\"landing\".\"ride_transactions\"\n  security definer\n  as\n    \n\nWITH user AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"users\"\n),\nvehicle AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_vehicle\"\n),\nsubscription AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_subscription\"\n),\nstripe AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"mongodb_stripe\"\n),\npayment AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_payments\"\n)\nSELECT\n    rides.ride_id AS ride_id,\n    rides.user_id AS user_id,\n    rides.vehicle_id AS vehicle_id,\n    rides.subscription_id AS subscription_id,\n    rides.stripe_id AS stripe_id,\n    rides.payment_id AS payment_id,\n    user.full_name AS user_full_name,\n    user.cpf AS user_cpf,\n    rides.source AS source,\n    rides.destination AS destination,\n    rides.estimated_price AS estimated_price,\n    rides.surge_multiplier AS dynamic_fare,\n    rides.price AS price,\n    vehicle.name AS vehicle_name,\n    vehicle.year AS vehicle_year,\n    vehicle.km_driven AS vehicle_km_driven,\n    vehicle.seats AS vehicle_seats,\n    subscription.plan AS subscription_plan,\n    subscription.status AS subscription_status,\n    subscription.payment_method AS subscription_payment_method,\n    stripe.identifier AS stripe_identifier,\n    stripe.card_type AS stripe_card_type,\n    payment.city AS payment_city,\n    payment.country AS payment_country,\n    payment.currency AS payment_currency,\n    payment.credit_card_type AS payment_credit_card_type,\n    payment.price AS payment_price\nFROM\n    \"iceberg\".\"landing\".\"mongodb_rides\" AS rides\n    LEFT OUTER JOIN USER AS USER\n    ON rides.user_id = USER.user_id\n    LEFT OUTER JOIN vehicle AS vehicle\n    ON rides.vehicle_id = vehicle.vehicle_id\n    LEFT OUTER JOIN subscription AS subscription\n    ON rides.subscription_id = subscription.subscription_id\n    LEFT OUTER JOIN stripe AS stripe\n    ON rides.stripe_id = stripe.stripe_id\n    LEFT OUTER JOIN payment AS payment\n    ON rides.payment_id = payment.payment_id\n  ", "query_id": "20240223_200639_00618_m7mg4"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.ride_transactions", "compiled": true, "compiled_code": "\n\nWITH user AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"users\"\n),\nvehicle AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_vehicle\"\n),\nsubscription AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_subscription\"\n),\nstripe AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"mongodb_stripe\"\n),\npayment AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_payments\"\n)\nSELECT\n    rides.ride_id AS ride_id,\n    rides.user_id AS user_id,\n    rides.vehicle_id AS vehicle_id,\n    rides.subscription_id AS subscription_id,\n    rides.stripe_id AS stripe_id,\n    rides.payment_id AS payment_id,\n    user.full_name AS user_full_name,\n    user.cpf AS user_cpf,\n    rides.source AS source,\n    rides.destination AS destination,\n    rides.estimated_price AS estimated_price,\n    rides.surge_multiplier AS dynamic_fare,\n    rides.price AS price,\n    vehicle.name AS vehicle_name,\n    vehicle.year AS vehicle_year,\n    vehicle.km_driven AS vehicle_km_driven,\n    vehicle.seats AS vehicle_seats,\n    subscription.plan AS subscription_plan,\n    subscription.status AS subscription_status,\n    subscription.payment_method AS subscription_payment_method,\n    stripe.identifier AS stripe_identifier,\n    stripe.card_type AS stripe_card_type,\n    payment.city AS payment_city,\n    payment.country AS payment_country,\n    payment.currency AS payment_currency,\n    payment.credit_card_type AS payment_credit_card_type,\n    payment.price AS payment_price\nFROM\n    \"iceberg\".\"landing\".\"mongodb_rides\" AS rides\n    LEFT OUTER JOIN USER AS USER\n    ON rides.user_id = USER.user_id\n    LEFT OUTER JOIN vehicle AS vehicle\n    ON rides.vehicle_id = vehicle.vehicle_id\n    LEFT OUTER JOIN subscription AS subscription\n    ON rides.subscription_id = subscription.subscription_id\n    LEFT OUTER JOIN stripe AS stripe\n    ON rides.stripe_id = stripe.stripe_id\n    LEFT OUTER JOIN payment AS payment\n    ON rides.payment_id = payment.payment_id", "relation_name": "\"iceberg\".\"landing\".\"ride_transactions\""}], "elapsed_time": 2.5903286933898926, "args": {"printer_width": 80, "defer": false, "log_level_file": "debug", "use_colors": true, "invocation_command": "dbt ", "populate_cache": true, "exclude": [], "indirect_selection": "eager", "print": true, "log_format_file": "debug", "static_parser": true, "vars": {}, "send_anonymous_usage_stats": true, "favor_state": false, "select": ["ride_transactions"], "quiet": false, "strict_mode": false, "use_colors_file": true, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "show_resource_report": false, "macro_debugging": false, "log_path": "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs", "project_dir": "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq", "partial_parse_file_diff": true, "introspect": true, "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "version_check": true, "write_json": true, "cache_selected_only": false, "partial_parse": true, "log_level": "info", "profiles_dir": "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq", "log_format": "default"}}